<div class="container mt-4">
  <h2 class="text-center mb-4">Gesti√≥n de Historias M√©dicas</h2>

  <!-- FORMULARIO -->
  <form [formGroup]="form" (ngSubmit)="guardarHistoria()" class="mb-4" novalidate>
    <div class="row">
      <!-- FECHA -->
      <div class="col-md-4 mb-3">
        <label for="fecha" class="form-label">Fecha</label>
        <input
          type="date"
          id="fecha"
          class="form-control"
          formControlName="fecha"
        />
      </div>

      <!-- PACIENTE -->
      <div class="col-md-4 mb-3">
        <label for="pacienteId" class="form-label">Paciente</label>
        <select id="pacienteId" class="form-select" formControlName="pacienteId">
          <option value="">Seleccione un paciente</option>
          <option *ngFor="let p of pacientes" [value]="p.id">
            {{ p.nombres }} {{ p.apellidos }}
          </option>
        </select>
      </div>

      <!-- M√âDICO -->
      <div class="col-md-4 mb-3">
        <label for="medicoId" class="form-label">M√©dico</label>
        <select id="medicoId" class="form-select" formControlName="medicoId">
          <option value="">Seleccione un m√©dico</option>
          <option *ngFor="let m of medicos" [value]="m.id">
            {{ m.nombres }} {{ m.apellidos }}
          </option>
        </select>
      </div>
    </div>

    <!-- DIAGN√ìSTICO -->
    <div class="mb-3">
      <label for="diagnostico" class="form-label">Diagn√≥stico</label>
      <textarea
        id="diagnostico"
        class="form-control"
        rows="3"
        formControlName="diagnostico"
      ></textarea>
    </div>

    <!-- TRATAMIENTO -->
    <div class="mb-3">
      <label for="tratamiento" class="form-label">Tratamiento</label>
      <textarea
        id="tratamiento"
        class="form-control"
        rows="3"
        formControlName="tratamiento"
      ></textarea>
    </div>

    <button type="submit" class="btn btn-primary">Guardar Historia</button>
  </form>

  <!-- TABLA -->
  <table class="table table-bordered table-striped">
    <thead>
      <tr>
        <th>ID</th>
        <th>Fecha</th>
        <th>Paciente</th>
        <th>M√©dico</th>
        <th>Diagn√≥stico</th>
        <th>Tratamiento</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let h of historiasMedicas">
        <td>{{ h.id }}</td>
        <td>{{ h.fecha }}</td>
        <td>{{ h.paciente?.nombres }} {{ h.paciente?.apellidos }}</td>
        <td>{{ h.medico?.nombres }} {{ h.medico?.apellidos }}</td>
        <td>{{ h.diagnostico }}</td>
        <td>{{ h.tratamiento }}</td>
        <td>
          <button class="btn btn-danger btn-sm" (click)="eliminarHistoria(h.id)">üóëÔ∏è</button>
        </td>
      </tr>
    </tbody>
  </table>
</div>



