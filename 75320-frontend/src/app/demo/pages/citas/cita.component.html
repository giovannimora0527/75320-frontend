<div class="container mt-4">
  <div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
      <h3 class="mb-0"><i class="fa fa-calendar"></i>&nbsp; Gestión de Citas</h3>
      <button type="button" class="btn btn-outline-primary" (click)="nuevaCita()" title="Agregar nueva cita">
        Nueva Cita
      </button>
    </div>

    <div class="card-body">
      <div *ngIf="mostrarFormulario" class="mb-4">
        <form [formGroup]="citaForm">
          <div class="row">
            <div class="col-md-4 mb-3">
              <label class="form-label" for="pacienteSelect">Paciente</label>
              <select id="pacienteSelect" formControlName="pacienteId" class="form-select" title="Seleccione un paciente">
                <option value="">Seleccione un paciente</option>
                <option *ngFor="let paciente of pacientes" [value]="paciente.id">
                  {{ paciente.nombres }} {{ paciente.apellidos }}
                </option>
              </select>
            </div>

            <div class="col-md-4 mb-3">
              <label class="form-label" for="medicoSelect">Médico</label>
              <select id="medicoSelect" formControlName="medicoId" class="form-select" title="Seleccione un médico">
                <option value="">Seleccione un médico</option>
                <option *ngFor="let medico of medicos" [value]="medico.id">
                  {{ medico.nombres }} {{ medico.apellidos }}
                </option>
              </select>
            </div>

            <div class="col-md-2 mb-3">
              <label class="form-label" for="fechaInput">Fecha</label>
              <input id="fechaInput" type="date" formControlName="fechaCita" class="form-control" title="Seleccione la fecha de la cita">
            </div>

            <div class="col-md-2 mb-3">
              <label class="form-label" for="horaInput">Hora</label>
              <input id="horaInput" type="time" formControlName="hora" class="form-control" title="Seleccione la hora de la cita">
            </div>
          </div>

          <div class="mb-3">
            <label class="form-label" for="motivoInput">Motivo</label>
            <input id="motivoInput" type="text" formControlName="motivo" class="form-control" placeholder="Ingrese el motivo de la cita" title="Ingrese el motivo de la cita">
          </div>

          <div class="d-flex justify-content-end">
            <button type="button" class="btn btn-secondary me-2" (click)="cancelar()" title="Cancelar registro de cita">Cancelar</button>
            <button type="button" class="btn btn-primary" (click)="guardarCita()" title="Guardar cita">
              {{ editando ? 'Actualizar' : 'Guardar' }}
            </button>
          </div>
        </form>
      </div>

      <div class="table-responsive">
        <table class="table table-striped table-hover">
          <thead>
            <tr>
              <th>Id</th>
              <th>Paciente</th>
              <th>Médico</th>
              <th>Fecha</th>
              <th>Hora</th>
              <th>Motivo</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let cita of citas">
              <td>{{ cita.id }}</td>
              <td>{{ cita.paciente?.nombres }} {{ cita.paciente?.apellidos }}</td>
              <td>{{ cita.medico?.nombres }} {{ cita.medico?.apellidos }}</td>
              <td>{{ cita.fechaCita }}</td>
              <td>{{ cita.hora }}</td>
              <td>{{ cita.motivo }}</td>
              <td>
                <button type="button" class="btn btn-sm btn-outline-primary me-1" (click)="abrirEditarCita(cita)" title="Editar cita">
                  Editar
                </button>
                <button type="button" class="btn btn-sm btn-outline-danger" (click)="eliminarCita(cita.id)" title="Eliminar cita">
                  Eliminar
                </button>
              </td>
            </tr>
            <tr *ngIf="citas.length === 0">
              <td colspan="7" class="text-center">-- No hay citas registradas aún --</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>



